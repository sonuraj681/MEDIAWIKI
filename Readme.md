Mediawiki Installation on AWS using Ansible Playbook: 
========================================================
 - Terraform Module that does the following: 
 	- 1 VPC
 	- 3 Subnets  
 	- 1 Keypair 
 	- 3 EC2 Instances - 2 Web and 1 DB
 	- 1 Elastic Load Balancer
   
 - Ansible Playbook that performs the following: 
    - Dynamically fetches resources details based on the tags that are defined in the terraform. 
    - Performs the Installation of the MariaDB Database
    - Creates the Database and Users and other tasks.
    - Encrypts the passwords into a ansible vault. 
    - Role that installs Apache, PHP from third-party repositories.
    - Configures the webserver
    - Makes it ready for the Launch on the browser. 


Assumptions/Pre-Requisites: 
---------------------------
1. Terraform is installed and the PATH is set. 

	https://www.terraform.io/intro/getting-started/install.html

2. AWS Secret variables are set: 

	export AWS_ACCESS_KEY_ID=xxx
	export AWS_SECRET_ACCESS_KEY=xxx

3. Python 2.7+ and Ansible 2.x is installed

	wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
	rpm -ivh epel-release-6-8.noarch.rpm
	yum install ansible -y

Steps to setup
---------------
1. Clone and switch the directory to the Repository. 

2. Navigate to the folder: aws-terraform:

   cd aws-terraform

3. Initialize the working directory.:

    terraform init -input=false

4. Create a plan and save it to the local file tfplan: 

   terraform plan -out=tfplan

5. Apply the plan stored in the file tfplan.

   terraform apply tfplan

6. Output the autogenerated keypair into a file for ansible. 

   terraform output pem > ..\ansible-playbook\mediawiki.pem

7. Run Ansible Playbook for the DB Role:

   cd ../ansible-playbook

    ansible-playbook site.yml -i ec2.py -vv --private-key mediawiki.pem -i ec2.py --limit "tag_group_db" --tags "install_db" --ask-vault-pass -u ec2-user

8. Run Ansible Playbook for the DB Role:

   ansible-playbook site.yml -i ec2.py -vv --private-key mediawiki.pem -i ec2.py --limit "tag_group_web" --tags "install_web" --ask-vault-pass -u ec2-user
   Note: sonu is the vault key 

9. Open the Browser and complete the installation wizard. 
